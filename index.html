<script>
  const form = document.getElementById('reportForm');
  const resultDiv = document.getElementById('result');
  const output = document.getElementById('output');

  form.addEventListener('submit', async (e) => {
    e.preventDefault();

    output.innerText = "Loading...";
    resultDiv.classList.remove('hidden');

    try {
      const res = await fetch("https://cjramki.app.n8n.cloud/webhook/75135e98-607e-4da0-8432-3c79ec5c3db9", {
        method: "GET",
        headers: {
          "Content-Type": "application/json"
        }
      });

      const data = await res.json();

      // Safely inject the HTML into output div
      if (data.html) {
        output.innerHTML = data.html;
      } else {
        output.innerText = "No HTML found in response.";
      }
    } catch (err) {
      output.innerText = "Error fetching report: " + err.message;
    }
  });
</script>
